<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Configurator - Craneshell</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <header id="header"></header>

    <main class="container">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- HEADER -->
            <div style="margin-bottom: 32px;">
                <h1 style="margin-bottom: 8px;">üé® Color Configurator</h1>
                <p style="color: var(--color-text-secondary);">Create beautiful terminal color themes with 16 colors</p>
            </div>

            <!-- MAIN LAYOUT: 2 COLUMNS -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px;">
                <!-- LEFT SIDE: COLOR PICKERS -->
                <div class="card" style="padding: 24px;">
                    <h3 style="margin-bottom: 20px;">üìã Colors (16 palette)</h3>
                    
                    <!-- GRID OF 16 COLOR PICKERS (4x4) -->
                    <div class="colors-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px;">
                        <!-- Row 1 -->
                        <div class="form-group">
                            <label for="color0">Black (0)</label>
                            <input type="color" id="color0" value="#000000" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color1">Red (1)</label>
                            <input type="color" id="color1" value="#ff0000" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color2">Green (2)</label>
                            <input type="color" id="color2" value="#00ff00" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color3">Yellow (3)</label>
                            <input type="color" id="color3" value="#ffff00" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>

                        <!-- Row 2 -->
                        <div class="form-group">
                            <label for="color4">Blue (4)</label>
                            <input type="color" id="color4" value="#0000ff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color5">Magenta (5)</label>
                            <input type="color" id="color5" value="#ff00ff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color6">Cyan (6)</label>
                            <input type="color" id="color6" value="#00ffff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color7">White (7)</label>
                            <input type="color" id="color7" value="#ffffff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>

                        <!-- Row 3 (Bright versions) -->
                        <div class="form-group">
                            <label for="color8">Bright Black (8)</label>
                            <input type="color" id="color8" value="#555555" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color9">Bright Red (9)</label>
                            <input type="color" id="color9" value="#ff5555" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color10">Bright Green (10)</label>
                            <input type="color" id="color10" value="#55ff55" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color11">Bright Yellow (11)</label>
                            <input type="color" id="color11" value="#ffff55" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>

                        <!-- Row 4 (Bright versions cont.) -->
                        <div class="form-group">
                            <label for="color12">Bright Blue (12)</label>
                            <input type="color" id="color12" value="#5555ff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color13">Bright Magenta (13)</label>
                            <input type="color" id="color13" value="#ff55ff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color14">Bright Cyan (14)</label>
                            <input type="color" id="color14" value="#55ffff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="color15">Bright White (15)</label>
                            <input type="color" id="color15" value="#ffffff" class="form-control color-input" style="height: 60px; cursor: pointer;">
                        </div>
                    </div>

                    <!-- SPECIAL COLORS -->
                    <hr style="border: none; border-top: 1px solid var(--color-border); margin: 24px 0;">
                    
                    <h4 style="margin-bottom: 16px;">üîß Special Colors</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="form-group">
                            <label for="foreground">Foreground</label>
                            <input type="color" id="foreground" value="#ffffff" class="form-control special-color" style="height: 50px; cursor: pointer;">
                        </div>
                        <div class="form-group">
                            <label for="background">Background</label>
                            <input type="color" id="background" value="#000000" class="form-control special-color" style="height: 50px; cursor: pointer;">
                        </div>
                    </div>

                    <!-- OPACITY SLIDER -->
                    <div class="form-group" style="margin-top: 16px;">
                        <label for="opacity">Opacity: <span id="opacityValue">100</span>%</label>
                        <input type="range" id="opacity" min="0" max="100" value="100" class="form-control" style="cursor: pointer; height: 8px;">
                    </div>

                    <!-- COLOR PREVIEW (4x4) -->
                    <hr style="border: none; border-top: 1px solid var(--color-border); margin: 24px 0;">
                    <h4 style="margin-bottom: 12px;">üìã Palette Preview</h4>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                        <div id="prev0" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #000000;"></div>
                        <div id="prev1" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ff0000;"></div>
                        <div id="prev2" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #00ff00;"></div>
                        <div id="prev3" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ffff00;"></div>
                        
                        <div id="prev4" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #0000ff;"></div>
                        <div id="prev5" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ff00ff;"></div>
                        <div id="prev6" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #00ffff;"></div>
                        <div id="prev7" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ffffff;"></div>
                        
                        <div id="prev8" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #555555;"></div>
                        <div id="prev9" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ff5555;"></div>
                        <div id="prev10" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #55ff55;"></div>
                        <div id="prev11" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ffff55;"></div>
                        
                        <div id="prev12" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #5555ff;"></div>
                        <div id="prev13" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ff55ff;"></div>
                        <div id="prev14" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #55ffff;"></div>
                        <div id="prev15" style="height: 40px; border-radius: 8px; border: 1px solid var(--color-border); background: #ffffff;"></div>
                    </div>
                </div>

                <!-- RIGHT SIDE: TERMINAL -->
                <div class="card" style="padding: 0; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="padding: 24px; border-bottom: 1px solid var(--color-border);">
                        <h3 style="margin: 0 0 8px 0;">üñ•Ô∏è Interactive Terminal</h3>
                        <p style="margin: 0; font-size: 12px; color: var(--color-text-secondary);">–í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Ü–≤–µ—Ç–æ–≤</p>
                    </div>
                    
                    <!-- TERMINAL OUTPUT -->
                    <div id="terminalContent" style="flex: 1; padding: 16px; background: #000000; color: #ffffff; font-family: 'Courier New', monospace; font-size: 13px; overflow-y: auto; min-height: 400px; line-height: 1.6; white-space: pre-wrap; word-wrap: break-word; border-bottom: 1px solid var(--color-border);">
                        Welcome to Craneshell Terminal!
Type 'help' for available commands.
                    </div>

                    <!-- TERMINAL INPUT -->
                    <div style="padding: 16px; background: #000000; border-top: 1px solid var(--color-border); display: flex; gap: 8px;">
                        <span id="terminalPrompt" style="color: #00ff00; white-space: nowrap;">$ </span>
                        <input type="text" id="terminalInput" placeholder="Enter command..." style="flex: 1; background: transparent; color: #ffffff; border: none; outline: none; font-family: 'Courier New', monospace; font-size: 13px; caret-color: #00ff00;">
                    </div>
                </div>
            </div>

            <!-- ACTIONS BUTTONS -->
            <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 24px;">
                <button class="btn btn-primary" onclick="saveConfig()" style="flex: 1; min-width: 150px;">
                    üíæ Save Config
                </button>
                <button class="btn btn-primary" onclick="downloadConfig()" style="flex: 1; min-width: 150px;">
                    üì• Download
                </button>
                <button class="btn" onclick="copyToClipboard()" style="flex: 1; min-width: 150px;">
                    üìã Copy JSON
                </button>
                <button class="btn" onclick="randomizeColors()" style="flex: 1; min-width: 150px;">
                    üé≤ Random
                </button>
                <button class="btn" onclick="resetColors()" style="flex: 1; min-width: 150px;">
                    üîÑ Reset
                </button>
            </div>
        </div>
    </main>

    <script type="module">
        import { initPage } from './js/init.js';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π —Å—Ç—Ä–∞–Ω–∏—Ü—É
        await initPage();

        let colors = {};
        let commandHistory = [];
        let historyIndex = -1;

        function getColors() {
            const newColors = {};
            for (let i = 0; i < 16; i++) {
                newColors[i] = document.getElementById(`color${i}`)?.value || '#000000';
            }
            return newColors;
        }

        function updateAllPreviews() {
            colors = getColors();
            
            for (let i = 0; i < 16; i++) {
                const preview = document.getElementById(`prev${i}`);
                if (preview) {
                    preview.style.background = colors[i];
                }
            }
            
            updateTerminalStyle();
        }

        function updateTerminalStyle() {
            const terminal = document.getElementById('terminalContent');
            const input = document.getElementById('terminalInput');
            const prompt = document.getElementById('terminalPrompt');
            const fg = document.getElementById('foreground');
            const bg = document.getElementById('background');
            const opacity = document.getElementById('opacity');
            
            if (!terminal || !fg || !bg || !opacity) return;
            
            const fgColor = fg.value || '#ffffff';
            const bgColor = bg.value || '#000000';
            const opacityVal = opacity.value / 100;
            
            terminal.style.color = fgColor;
            terminal.style.backgroundColor = bgColor;
            terminal.style.opacity = opacityVal;
            
            input.style.color = fgColor;
            input.style.backgroundColor = bgColor;
            input.style.opacity = opacityVal;
            
            prompt.style.color = colors[2] || '#00ff00';
        }

        function printToTerminal(text, colorIndex = null) {
            const terminal = document.getElementById('terminalContent');
            const line = document.createElement('div');
            line.style.whiteSpace = 'pre-wrap';
            line.style.wordWrap = 'break-word';
            
            if (colorIndex !== null && colors[colorIndex]) {
                line.style.color = colors[colorIndex];
            }
            
            line.textContent = text;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function clearTerminal() {
            const terminal = document.getElementById('terminalContent');
            terminal.innerHTML = '';
        }

        function executeCommand(cmd) {
            const terminal = document.getElementById('terminalContent');
            const fg = document.getElementById('foreground').value;
            
            // –í—ã–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É
            const cmdLine = document.createElement('div');
            cmdLine.style.color = colors[2] || '#00ff00';
            cmdLine.textContent = '$ ' + cmd;
            terminal.appendChild(cmdLine);
            
            let output = '';
            
            switch(cmd.toLowerCase().trim()) {
                case 'help':
                    output = `Available commands:
  help           - Show this help message
  colors         - Display all 16 colors
  test           - Color test with text
  cat file.txt   - Display sample file
  ls -la         - List files with colors
  echo TEXT      - Echo text with random colors
  clear          - Clear terminal
  about          - About Craneshell
  palette        - Show color palette`;
                    printToTerminal(output, 7);
                    break;
                    
                case 'colors':
                    printToTerminal('ANSI 256 Color Palette:', 6);
                    for (let i = 0; i < 16; i++) {
                        const line = document.createElement('div');
                        line.style.color = colors[i];
                        line.textContent = `  Color ${i.toString().padStart(2, '0')}: ${colors[i]}`;
                        terminal.appendChild(line);
                    }
                    break;
                    
                case 'test':
                    for (let i = 0; i < 16; i++) {
                        const line = document.createElement('div');
                        line.style.color = colors[i];
                        line.innerHTML = `<span style="background-color: ${colors[(i+8)%16]}; padding: 0 4px;">Text in color ${i}</span>`;
                        terminal.appendChild(line);
                    }
                    break;
                    
                case 'cat file.txt':
                case 'cat file':
                    output = `#!/usr/bin/env bash
# Craneshell Configuration
# Created with Craneshell Terminal

export TERM=xterm-256color

# Colors configuration
COLOR_BLACK="${colors[0]}"
COLOR_RED="${colors[1]}"
COLOR_GREEN="${colors[2]}"
COLOR_YELLOW="${colors[3]}"
COLOR_BLUE="${colors[4]}"
COLOR_MAGENTA="${colors[5]}"
COLOR_CYAN="${colors[6]}"
COLOR_WHITE="${colors[7]}"`;
                    
                    output.split('\n').forEach((line, idx) => {
                        if (line.includes('COLOR_')) {
                            printToTerminal(line, 3);
                        } else if (line.startsWith('#')) {
                            printToTerminal(line, 2);
                        } else {
                            printToTerminal(line, 7);
                        }
                    });
                    break;
                    
                case 'ls -la':
                case 'ls':
                    const files = [
                        '.rwxr-xr-x  user  group  4096  Dec 3 23:00  .',
                        '.rwxr-xr-x  user  group  4096  Dec 3 22:50  ..',
                        '-rw-r--r--  user  group  1024  Dec 3 23:05  config.yaml',
                        '-rw-r--r--  user  group  2048  Dec 3 23:04  theme.json',
                        'drwxr-xr-x  user  group  4096  Dec 3 23:00  .git',
                        '-rwxr-xr-x  user  group  8192  Dec 3 23:02  craneshell'
                    ];
                    
                    files.forEach((file, idx) => {
                        if (file.startsWith('d')) {
                            printToTerminal(file, 4);
                        } else if (file.includes('craneshell')) {
                            printToTerminal(file, 3);
                        } else {
                            printToTerminal(file, 7);
                        }
                    });
                    break;
                    
                case 'about':
                    output = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë         CRANESHELL v1.0.0               ‚ïë
‚ïë    Terminal Color Theme Generator       ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Create beautiful terminal color themes with
16 interactive ANSI colors.

Type 'help' for available commands.`;
                    printToTerminal(output, 6);
                    break;
                    
                case 'palette':
                    printToTerminal('Color Palette (0-15):', 6);
                    let paletteStr = '';
                    for (let i = 0; i < 16; i++) {
                        const colorBox = document.createElement('span');
                        colorBox.style.backgroundColor = colors[i];
                        colorBox.style.color = colors[i];
                        colorBox.style.padding = '2px 4px';
                        colorBox.style.marginRight = '2px';
                        colorBox.textContent = '‚ñà';
                        terminal.appendChild(colorBox);
                        
                        if ((i + 1) % 8 === 0) {
                            terminal.appendChild(document.createElement('br'));
                        }
                    }
                    break;
                    
                case 'clear':
                    clearTerminal();
                    break;
                    
                case '':
                    break;
                    
                default:
                    output = `Command not found: ${cmd}
Type 'help' for available commands.`;
                    printToTerminal(output, 1);
            }
            
            terminal.scrollTop = terminal.scrollHeight;
        }

        // Color input listeners
        for (let i = 0; i < 16; i++) {
            const input = document.getElementById(`color${i}`);
            if (input) {
                input.addEventListener('input', updateAllPreviews);
                input.addEventListener('change', updateAllPreviews);
            }
        }

        // Foreground/Background listeners
        const fgInput = document.getElementById('foreground');
        const bgInput = document.getElementById('background');
        if (fgInput) {
            fgInput.addEventListener('input', updateTerminalStyle);
            fgInput.addEventListener('change', updateTerminalStyle);
        }
        if (bgInput) {
            bgInput.addEventListener('input', updateTerminalStyle);
            bgInput.addEventListener('change', updateTerminalStyle);
        }

        // Opacity slider
        const opacityInput = document.getElementById('opacity');
        if (opacityInput) {
            opacityInput.addEventListener('input', (e) => {
                document.getElementById('opacityValue').textContent = e.target.value;
                updateTerminalStyle();
            });
        }

        // Terminal input handler
        const terminalInput = document.getElementById('terminalInput');
        if (terminalInput) {
            terminalInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    const cmd = terminalInput.value;
                    if (cmd.trim()) {
                        commandHistory.push(cmd);
                        historyIndex = -1;
                        executeCommand(cmd);
                    }
                    terminalInput.value = '';
                    terminalInput.focus();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    historyIndex++;
                    if (historyIndex >= commandHistory.length) {
                        historyIndex = commandHistory.length - 1;
                    }
                    terminalInput.value = commandHistory[commandHistory.length - 1 - historyIndex] || '';
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    historyIndex--;
                    if (historyIndex < 0) {
                        historyIndex = -1;
                        terminalInput.value = '';
                    } else {
                        terminalInput.value = commandHistory[commandHistory.length - 1 - historyIndex];
                    }
                }
            });
            terminalInput.focus();
        }

        updateAllPreviews();
        printToTerminal('Welcome to Craneshell Terminal!', 6);
        printToTerminal('Type "help" for available commands.', 7);
        
        console.log('‚úÖ Terminal Configurator initialized!');

        // Save/Download functions
        window.saveConfig = async function() {
            const colorsList = [];
            for (let i = 0; i < 16; i++) {
                colorsList.push(document.getElementById(`color${i}`).value);
            }
            
            const config = {
                name: prompt('Config name:', 'My Theme') || 'My Theme',
                colors: colorsList,
                foreground: document.getElementById('foreground').value,
                background: document.getElementById('background').value,
                opacity: document.getElementById('opacity').value
            };
            
            alert('‚úÖ Config saved! (Backend integration needed)');
        };

        window.downloadConfig = function() {
            const colorsList = [];
            for (let i = 0; i < 16; i++) {
                colorsList.push(document.getElementById(`color${i}`).value);
            }
            
            const config = {
                name: 'Craneshell Theme',
                colors: colorsList,
                foreground: document.getElementById('foreground').value,
                background: document.getElementById('background').value,
                opacity: document.getElementById('opacity').value
            };
            
            const json = JSON.stringify(config, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'craneshell-theme.json';
            a.click();
            URL.revokeObjectURL(url);
        };

        window.copyToClipboard = function() {
            const colorsList = [];
            for (let i = 0; i < 16; i++) {
                colorsList.push(document.getElementById(`color${i}`).value);
            }
            
            const config = {
                colors: colorsList,
                foreground: document.getElementById('foreground').value,
                background: document.getElementById('background').value
            };
            
            const json = JSON.stringify(config, null, 2);
            navigator.clipboard.writeText(json).then(() => {
                alert('‚úÖ Copied to clipboard!');
            });
        };

        window.randomizeColors = function() {
            for (let i = 0; i < 16; i++) {
                const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
                const input = document.getElementById(`color${i}`);
                if (input) input.value = randomColor;
            }
            updateAllPreviews();
        };

        window.resetColors = function() {
            const defaultColors = [
                '#000000', '#ff0000', '#00ff00', '#ffff00',
                '#0000ff', '#ff00ff', '#00ffff', '#ffffff',
                '#555555', '#ff5555', '#55ff55', '#ffff55',
                '#5555ff', '#ff55ff', '#55ffff', '#ffffff'
            ];
            
            for (let i = 0; i < 16; i++) {
                const input = document.getElementById(`color${i}`);
                if (input) input.value = defaultColors[i];
            }
            updateAllPreviews();
        };
    </script>
</body>
</html>
